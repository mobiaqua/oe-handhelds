From 28a13f0be734958c74ae5a23d9cf766fa0857a62 Mon Sep 17 00:00:00 2001
From: Vincent Penquerc'h <vincent.penquerch@collabora.co.uk>
Date: Tue, 9 Oct 2012 14:48:34 +0100
Subject: [PATCH] omap: release lock also on error paths

Signed-off-by: Rob Clark <rob@ti.com>
---
 omap/omap_drm.c |    2 ++
 1 file changed, 2 insertions(+)

Index: libdrm/omap/omap_drm.c
===================================================================
--- libdrm.orig/omap/omap_drm.c	2013-03-06 16:18:44.983937480 +0100
+++ libdrm/omap/omap_drm.c	2013-03-06 16:28:08.539924591 +0100
@@ -220,6 +220,8 @@
 	return bo;
 
 fail:
+	pthread_mutex_unlock(&table_lock);
+	pthread_mutex_unlock(&table_lock);
 	free(bo);
 	return NULL;
 }
